select 'DQ_NN_AMC_CUST_ACCOUNT_1', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8, AMC_CUST_ACCOUNT.FIRMCODE errcol,  case (AMC_CUST_ACCOUNT.FIRMCODE is null and AMC_CUST_ACCOUNT.FIRMCODE = ) When True Then 1 Else 0 end NullChkResult from AMC_CUST_ACCOUNT where 1=1
select 'DQ_NN_AMC_CUST_ACCOUNT_1', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8, AMC_CUST_ACCOUNT.FIRMCODE errcol from AMC_CUST_ACCOUNT where (AMC_CUST_ACCOUNT.FIRMCODE is not null or AMC_CUST_ACCOUNT.FIRMCODE != '') and (length(AMC_CUST_ACCOUNT.FIRMCODE) < 0 OR length(AMC_CUST_ACCOUNT.FIRMCODE) > 2)
select 'DQ_NN_AMC_CUST_ACCOUNT_1', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8, AMC_CUST_ACCOUNT.FIRMCODE errcol from AMC_CUST_ACCOUNT where (AMC_CUST_ACCOUNT.FIRMCODE is not null or AMC_CUST_ACCOUNT.FIRMCODE != '') and AMC_CUST_ACCOUNT.FIRMCODE not in (('AAPX','AAVP','BKR','SBSH','CHAR','CMTA','CONF','CONS','CAVP','CRI','CXL','OPCT','DOC','DUMY','FACI','SUSP','FUSD','GVUP','GAVP','IAP','INST','INTB','INTA','SBAL','INTI','SHED','IBKR','LGP','MKTM','OPRP','PBSB','PBBK','PRIV','PROP','RHDG','REPO','COLL','PSYF','ZALL','HALL','SPLT','CUST','STEX','BUYN','RECL','SWPC','SWNG','SYN','TEMP','TEST'))
select 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames,AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8, AMC_CUST_ACCOUNT.FIRMCODE errcol, case when (( . IS NULL OR + .='' ) and (1=1)) then 1 else 0 end  ref_Case from AMC_CUST_ACCOUNT LEFT OUTER JOIN on ( AMC_CUST_ACCOUNT.FIRMCODE=.)
select 'DQ_NN_AMC_CUST_ACCOUNT_1', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8,count(*) errcol from AMC_CUST_ACCOUNT where 1=1 GROUP BY ETL_FILEID,ETL_BATCHID,EAP_AS_OF_DT,IMSNUMBER HAVING COUNT(1)>1
select 'DQ_NN_AMC_CUST_ACCOUNT_2', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8, AMC_CUST_ACCOUNT.GFCID errcol from AMC_CUST_ACCOUNT where (AMC_CUST_ACCOUNT.GFCID is not null or AMC_CUST_ACCOUNT.GFCID != '') and (length(AMC_CUST_ACCOUNT.GFCID) < 0 OR length(AMC_CUST_ACCOUNT.GFCID) > 3)
select 'DQ_NN_AMC_CUST_ACCOUNT_2', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8, AMC_CUST_ACCOUNT.GFCID errcol from AMC_CUST_ACCOUNT where (AMC_CUST_ACCOUNT.GFCID is not null or AMC_CUST_ACCOUNT.GFCID != '') and AMC_CUST_ACCOUNT.GFCID not in (('AR','BF','DA','DC','DI','DW','EB','FC','FE','FF','FI','FR','IB','IC','II','PA','PB','PC','PF','PG','PH','PL','PN','PQ','PR','PS','PT','PW','PY','PZ','RO','RP','SB','SF','SI','WS','XB'))
select 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames,AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8, AMC_CUST_ACCOUNT.GFCID errcol, case when (( amc_all_accounts.IMSNumber IS NULL OR + amc_all_accounts.IMSNumber='' ) and (1=1)) then 1 else 0 end  ref_Case from AMC_CUST_ACCOUNT LEFT OUTER JOIN (select  IMSNUMBER from l1_amlmkt_amcg.amc_broker_account where eap_as_of_dt='2016-04-04' UNION ALL select  IMSNUMBER from l1_amlmkt_amcg.amc_cust_account  where  eap_as_of_dt='2016-04-04'  UNION ALL select IMSNUMBER from l1_amlmkt_amcg.amc_firm_account where eap_as_of_dt='2016-04-04')amc_all_accountson ( AMC_CUST_ACCOUNT.GFCID=amc_all_accounts.IMSNumber)
select 'DQ_NN_AMC_CUST_ACCOUNT_2', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8,count(*) errcol from AMC_CUST_ACCOUNT where 1=1 GROUP BY ETL_FILEID,ETL_BATCHID,EAP_AS_OF_DT,IMSNUMBER HAVING COUNT(1)>1
select 'DQ_NN_AMC_CUST_ACCOUNT_2', 'AMC_CUST_ACCOUNT.ETL_FILEID, AMC_CUST_ACCOUNT.ETL_BATCHID, AMC_CUST_ACCOUNT.EAP_AS_OF_DT, AMC_CUST_ACCOUNT.IMSNUMBER' pknames, AMC_CUST_ACCOUNT.ETL_FILEID pk1, AMC_CUST_ACCOUNT.ETL_BATCHID pk2, AMC_CUST_ACCOUNT.EAP_AS_OF_DT pk3, AMC_CUST_ACCOUNT.IMSNUMBER pk4, '-' pk5,'-' pk6, '-' pk7, '-' pk8,AMC_CUST_ACCOUNT.GFCID errcol from AMC_CUST_ACCOUNT where Not (AMC_CUST_ACCOUNT.GFCID is null or AMC_CUST_ACCOUNT.GFCID = '') and (GFCID like )
